<!doctype html>
<html lang="it">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Prenotazione - Eleven Cocktail Bar</title>

    <style>
      :root {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        color-scheme: dark;
      }
      body {
        margin: 0;
        background: #0b0f14;
        color: #eef2f7;
      }
      .wrap {
        max-width: 720px;
        margin: 0 auto;
        padding: 24px;
      }
      .card {
        background: rgba(255, 255, 255, 0.06);
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: 16px;
        padding: 18px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
      }
      h1 {
        margin: 0 0 10px;
        font-size: 22px;
      }
      p {
        margin: 0 0 18px;
        opacity: 0.9;
      }
      .grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
      }
      label {
        display: block;
        font-size: 13px;
        opacity: 0.9;
        margin: 0 0 6px;
      }
      input,
      textarea,
      select {
        width: 100%;
        padding: 10px 12px;
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.18);
        background: rgba(0, 0, 0, 0.25);
        color: #eef2f7;
      }
      .full {
        grid-column: 1 / -1;
      }
      .btn {
        padding: 12px 14px;
        border-radius: 14px;
        border: 1px solid rgba(255, 255, 255, 0.18);
        background: rgba(99, 179, 237, 0.22);
        color: #eef2f7;
        cursor: pointer;
        font-weight: 700;
      }
      .row {
        display: flex;
        justify-content: space-between;
        margin-top: 14px;
      }
      .status {
        font-size: 13px;
      }
      .ok { color: #7ee787; }
      .err { color: #ff7b72; }

      /* POPUP */
      .modal {
        position: fixed;
        inset: 0;
        display: none;
        place-items: center;
        background: rgba(0,0,0,.65);
        z-index: 9999;
      }
      .modal.show { display: grid; }
      .modal-card {
        width: min(720px, 95%);
        background: rgba(18,24,33,.98);
        border-radius: 16px;
        padding: 18px;
      }
      .modal-text {
        white-space: pre-wrap;
        background: rgba(255,255,255,.06);
        padding: 12px;
        border-radius: 12px;
        margin: 10px 0;
      }
    </style>
  </head>

  <body>
    <div class="wrap">
      <div class="card">
        <h1>Prenota un tavolo</h1>

        <form id="bookingForm">
          <div class="grid">
            <div class="full">
              <label>Nome e cognome *</label>
              <input id="nome" name="nome" required />
            </div>
            <div>
              <label>Data *</label>
              <input id="data" name="data" type="date" required />
            </div>
            <div>
              <label>Orario *</label>
              <input id="ora" name="ora" type="time" required />
            </div>
            <div>
              <label>Numero persone *</label>
              <select id="persone" name="persone" required>
                <option value="">Seleziona</option>
                <option>1</option><option>2</option><option>3</option>
                <option>4</option><option>5</option><option>6</option>
                <option>7</option><option>8</option><option>9</option><option>10</option>
              </select>
            </div>
          </div>

          <div class="row">
            <button class="btn" id="submitBtn">Conferma prenotazione</button>
            <div id="status" class="status"></div>
          </div>
        </form>
      </div>
    </div>

    <!-- POPUP -->
    <div id="confirmModal" class="modal">
      <div class="modal-card">
        <h2>Prenotazione confermata ✅</h2>
        <pre id="modalText" class="modal-text"></pre>
        <button class="btn" onclick="closeModal()">Chiudi</button>
      </div>
    </div>

    <script>
      const NTFY_TOPIC = "prenotazioni-eleven-cocktail-bar";
      const form = document.getElementById("bookingForm");
      const statusEl = document.getElementById("status");

      function formatDate(d) {
        const [y,m,day] = d.split("-");
        return `${day}/${m}/${y.slice(-2)}`;
      }

      function openModal(text) {
        document.getElementById("modalText").textContent = text;
        document.getElementById("confirmModal").classList.add("show");
      }
      function closeModal() {
        document.getElementById("confirmModal").classList.remove("show");
      }

      form.addEventListener("submit", async e => {
        e.preventDefault();
        const data = new FormData(form);
        const values = Object.fromEntries(data.entries());

        const message =
`Nome: ${values.nome}
Data: ${values.data}
Ora: ${values.ora}
Persone: ${values.persone}`;

        try {
          const res = await fetch(`https://ntfy.sh/${NTFY_TOPIC}`, {
            method: "POST",
            headers: { "Title": "Nuova prenotazione" },
            body: message
          });
          if (!res.ok) throw new Error();

          statusEl.textContent = "Prenotazione inviata!";
          statusEl.className = "status ok";

          openModal(
`Ciao ${values.nome}, ti confermiamo la tua prenotazione per ${values.persone}, ti aspettiamo il ${formatDate(values.data)} alle ${values.ora} e ti ricordiamo che il tavolo viene riservato per 30 minuti oltre l'orario di prenotazione.

Dopo 30 minuti di ritardo il tavolo viene annullato per dare la possibilità ad altri ospiti di accomodarsi.

Grazie per la prenotazione.

Buona giornata,
Manuel`
          );

          form.reset();
        } catch {
          statusEl.textContent = "Errore invio prenotazione";
          statusEl.className = "status err";
        }
      });
    </script>
  </body>
</html>

